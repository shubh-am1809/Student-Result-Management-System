{% extends "base.html" %}

{% block content %}
<h2>Result for {{ student['name'] }} (Roll: {{ student['roll_no'] }})</h2>
<p>Class: {{ student['class_name'] }}</p>
<p>DOB: {{ student['dob'] }}</p>

{% if results %}
  <div class="d-flex justify-content-between align-items-center mt-3">
    <h4>Subjects & Marks</h4>
    <a href="{{ url_for('export_result_pdf', roll_no=student['roll_no']) }}"
       class="btn btn-outline-secondary btn-sm">
      Download PDF
    </a>
  </div>

  <table class="table table-bordered mt-3">
    <thead>
      <tr>
        <th>Subject</th>
        <th>Marks</th>
        <th>Max Marks</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for row in results %}
      <tr>
        <td>{{ row['subject'] }}</td>
        <td>{{ row['marks'] }}</td>
        <td>{{ row['max_marks'] }}</td>
        <td>
          <a href="{{ url_for('edit_result', id=row['id']) }}" class="btn btn-warning btn-sm">Edit</a>
          <a href="{{ url_for('delete_result', id=row['id']) }}"
             class="btn btn-danger btn-sm"
             onclick="return confirm('Are you sure?')">
            Delete
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p><strong>Total:</strong> {{ total_obtained }} / {{ total_max }}</p>
  <p><strong>Percentage:</strong> {{ percentage }}%</p>
{% else %}
  <p class="mt-3">No results found for this student.</p>
{% endif %}
{% endblock %}
